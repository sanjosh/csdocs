
Taiji models edge-to-datacenter traffic routing as an assignment problem—assigning traffic objects at the edge to the data centers to satisfy service-level objectives. 

constraint optimization solver to generate an optimal routing table that specifies the fractions of traffic each edge node will distribute to different data centers.

connection-aware routing : use social network to decide assignment
1. exclude celebrity
2. exclude one-off connections

Two types
1. sticky traffic : prefer user be routed to same data center
2. stateless traffic

Edge nodes are much smaller in size and are situated close to the end users for two major functions:
1. reverse proxies for terminating user connections close to their ISPs, and 
2. caching and distribution of static content such as images and video

Major Internet services build private backbone networks or peering links that connect edge nodes to their data centers to avoid public WAN

traffic hops
1. The user request will first hit an L4 load balancer. 
2. L4 load balancer forwards the request to an L7 edge load balancer (Edge LB) where the user’s SSL connection is terminated. 
3. Each Edge LB runs a reverse proxy that maintains persistent secure connections to machine in data centers. 
4. Frontend L4 in data center 
5. Frontend L7 LB proxies request to web server
6. web server may communicate with tens or hundreds of micro services.

Connection-aware routing groups highlyconnected users into “buckets” and selectively routes buckets to the same data centers, based on the traffic fractions specified in the routing table. 
Note that connection-aware routing is per-product but it is agnostic to service-level objectives — it faithfully follows the routing table generated by the Runtime

Safety guards:
1. onloading safety guard, a configurable constant (0.04 in production) to bound how much the utilization of a data center can increase during an epoch. 
2. limit the max allowable fraction of traffic sent to a data center
3. minimum shift limit to ignore a proposed change if its below this limit, otherwise it causes oscillations
4. dampening factor : exact target cannot be met.  Aim for 80 percent of target


David Chou, 
Taiji: Managing Global User Traffic for Large-Scale Internet Services at the Edge
https://dl.acm.org/doi/pdf/10.1145/3341301.3359655
